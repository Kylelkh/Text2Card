# 📝 Text2Card Project Documentation

[English](./README_EN.md) | [中文](./README.md)

## ✅ Introduction
Text2Card is an elegant tool designed to convert text content into beautiful image cards. Unlike screenshot methods using headless browsers, Text2Card is lightweight, independent of external services, and generates images directly through function calls, making it highly efficient and easy to integrate. Now with OpenAI API compatibility, it can be seamlessly integrated into various AI applications.

## 🚀 Features
- **OpenAI API Compatible**: Supports standard OpenAI API format calls for easy integration.
- **Secure Authentication**: Token-based image access control with API key authentication.
- **Multiple Theme Colors**: Supports various gradient background colors for diverse card styles.
- **Markdown Parsing**: Supports basic Markdown syntax parsing, including headers and lists.
- **Auto Day/Night Mode**: Automatically switches between day and night modes based on time.
- **Image Titles**: Supports adding image titles at the top of cards.
- **Emoji Rendering**: Correctly renders and displays emoji characters.
- **High-Quality Output**: Generates high-resolution images suitable for sharing.
- **Auto Cleanup**: Periodically cleans expired image files.

## 🖼️ Example Showcase
Here's an example of an image generated using Text2Card:
![Example Card](./assets/example_card.png)
(Note: The above image demonstrates the card effect generated by Text2Card.)

## 🛠️ Installation

### 1. Clone the Repository
```bash
git clone https://github.com/LargeCupPanda/text2card.git
cd text2card
```

### 2. Environment Configuration
Create a `.env` file and set the necessary environment variables:
```plaintext
# Server Configuration
ENV=development
DEVELOPMENT_HOST=http://127.0.0.1:3000
PRODUCTION_HOST=https://your-production-domain.com
PORT=3000

# Security Configuration
SECRET_KEY=your-secret-key-here
API_KEYS=["your-test-api-key"]
TOKEN_EXPIRY=3600

# Storage Configuration
UPLOAD_FOLDER=picture
MAX_CONTENT_LENGTH=10485760
```

### 3. Install Dependencies
```bash
python3 -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt
```

### 4. Font File Preparation
Ensure the following font files are present in the project root directory:
- `msyh.ttc` (Microsoft YaHei Regular)
- `msyhbd.ttc` (Microsoft YaHei Bold)
- `TwitterColorEmoji.ttf` (Color Emoji Font)

## 📡 API Usage Guide

### OpenAI Format Call
```python
import requests

def generate_card(text, api_key):
    url = "http://127.0.0.1:3000/v1/chat/completions"
    headers = {
        "Authorization": f"Bearer {api_key}",
        "Content-Type": "application/json"
    }
    data = {
        "model": "Text2Card",
        "messages": [
            {
                "role": "user",
                "content": text
            }
        ]
    }
    response = requests.post(url, headers=headers, json=data)
    return response.json()

# Usage Example
result = generate_card("Text to convert", "your-api-key")
print(result)
```

### Response Format
```json
{
    "id": "text2card-1234567890",
    "object": "chat.completion",
    "created": 1234567890,
    "model": "Text2Card",
    "choices": [{
        "index": 0,
        "message": {
            "role": "assistant",
            "content": "http://127.0.0.1:3000/v1/images/20250102123456_abcdef.png"
        },
        "finish_reason": "stop"
    }]
}
```

## 📂 Project Structure
```
text2card/
├── assets/
│   └── example_card.png    # Example image
├── image_generator.py      # Image generation logic
├── app.py                  # API server implementation
├── config.py              # Configuration management
├── .env                   # Environment variables
├── requirements.txt       # Dependencies
├── msyh.ttc              # Microsoft YaHei Regular font
├── msyhbd.ttc            # Microsoft YaHei Bold font
├── TwitterColorEmoji.ttf # Color emoji font
└── README.md             # Project documentation
```

## 🔐 Security Notes
- API Key Authentication: All requests require API key authentication
- URL Token: Image access uses temporary tokens for enhanced security
- File Cleanup: Automatically cleans expired files to prevent storage buildup
- Environment Isolation: Supports separate development and production configurations

## 🤝 Contributing
If you have any suggestions or discover issues, please feel free to submit an Issue or Pull Request. Community contributions are highly welcome!

## 📄 License
This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.

---
We hope this tool helps you easily generate beautiful image cards! If you have any questions or suggestions, feel free to reach out. 🎉